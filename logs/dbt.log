

============================== 2023-05-18 19:37:03.731508 | c25bfd50-83f0-44fd-b65e-85b0a5c65e7c ==============================
[0m19:37:03.731508 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:37:03.733317 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m19:37:03.733673 [debug] [MainThread]: Tracking: tracking
[0m19:37:03.735295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277d8cc6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277d8ccaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277d8cd870>]}
[0m19:37:03.735964 [info ] [MainThread]: Setting up your profile.
[0m19:39:27.450995 [info ] [MainThread]: Profile coffee_shop_alh written to /home/vscode/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m19:39:27.451836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277d8cdcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277b4a9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277b4aa560>]}
[0m19:39:27.452337 [debug] [MainThread]: Flushing usage events


============================== 2023-05-18 19:40:25.493816 | 257e8f1b-fe00-47fe-b82c-4ce0d283a682 ==============================
[0m19:40:25.493816 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:40:25.496431 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:40:25.496805 [debug] [MainThread]: Tracking: tracking
[0m19:40:25.499775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea44aae020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea44aaf5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea44aad090>]}
[0m19:40:25.518949 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:40:25.519819 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:40:25.520780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '257e8f1b-fe00-47fe-b82c-4ce0d283a682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea44aafb80>]}
[0m19:40:26.344202 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_alh
[0m19:40:26.349955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '257e8f1b-fe00-47fe-b82c-4ce0d283a682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea44c03b20>]}
[0m19:40:26.356165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '257e8f1b-fe00-47fe-b82c-4ce0d283a682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea44c002b0>]}
[0m19:40:26.356599 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 336 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:40:26.357036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '257e8f1b-fe00-47fe-b82c-4ce0d283a682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea44ed4070>]}
[0m19:40:26.358089 [info ] [MainThread]: 
[0m19:40:26.358761 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:40:26.359332 [debug] [MainThread]: Command end result
[0m19:40:26.365157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea44c00370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea44a03b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea44a00400>]}
[0m19:40:26.365503 [debug] [MainThread]: Flushing usage events


============================== 2023-05-18 19:44:14.207032 | 761b573a-58fa-434b-9e08-7941ff6bffea ==============================
[0m19:44:14.207032 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:44:14.209905 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:44:14.210416 [debug] [MainThread]: Tracking: tracking
[0m19:44:14.212630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eea6733d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6cafa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6caf2e0>]}
[0m19:44:14.238228 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:44:14.277548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:44:14.277971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:44:14.278686 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_alh
[0m19:44:14.289500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '761b573a-58fa-434b-9e08-7941ff6bffea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6c51750>]}
[0m19:44:14.298521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '761b573a-58fa-434b-9e08-7941ff6bffea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6ba1c90>]}
[0m19:44:14.298934 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 336 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:44:14.299366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '761b573a-58fa-434b-9e08-7941ff6bffea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eea6733d0>]}
[0m19:44:14.300488 [info ] [MainThread]: 
[0m19:44:14.301168 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:44:14.301916 [debug] [MainThread]: Command end result
[0m19:44:14.307624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6ba1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6ba1150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6ba0fa0>]}
[0m19:44:14.307963 [debug] [MainThread]: Flushing usage events


============================== 2023-05-18 19:46:33.327354 | 93715c90-f03f-4309-83b5-796c58d11441 ==============================
[0m19:46:33.327354 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:46:33.330634 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:46:33.331004 [debug] [MainThread]: Tracking: tracking
[0m19:46:33.337529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0871c6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0871c7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0871c5ff0>]}
[0m19:46:33.357075 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:46:33.391668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:46:33.392496 [debug] [MainThread]: Partial parsing: added file: coffee_shop_alh://models/customers.sql
[0m19:46:33.412538 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m19:46:33.435629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93715c90-f03f-4309-83b5-796c58d11441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb086be80d0>]}
[0m19:46:33.510431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93715c90-f03f-4309-83b5-796c58d11441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb08731f4c0>]}
[0m19:46:33.510945 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 336 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:46:33.511415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93715c90-f03f-4309-83b5-796c58d11441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb08ac52ce0>]}
[0m19:46:33.512700 [info ] [MainThread]: 
[0m19:46:33.515442 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:46:33.516665 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m19:46:33.517186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:34.762876 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_aec-students_dbt_alh'
[0m19:46:34.763823 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_aec-students_dbt_alh'
[0m19:46:34.764337 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='aec-students', schema='dbt_alh', identifier=None)"
[0m19:46:34.785558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:34.786631 [debug] [ThreadPool]: On create_aec-students_dbt_alh: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "coffee_shop_alh", "target_name": "dev", "connection_name": "create_aec-students_dbt_alh"} */
create schema if not exists `aec-students`.`dbt_alh`
  
[0m19:46:36.019001 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:51e99860-75d6-4a1c-92e3-c3b61211e2b0&page=queryresults
[0m19:46:36.021669 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_alh'
[0m19:46:36.022156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:36.252684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93715c90-f03f-4309-83b5-796c58d11441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb08731e8f0>]}
[0m19:46:36.253802 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m19:46:36.254409 [info ] [MainThread]: 
[0m19:46:36.260389 [debug] [Thread-1 (]: Began running node model.coffee_shop_alh.customers
[0m19:46:36.261184 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_alh.customers .................................. [RUN]
[0m19:46:36.261887 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_alh.customers'
[0m19:46:36.262182 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_alh.customers
[0m19:46:36.263840 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_alh.customers"
[0m19:46:36.264487 [debug] [Thread-1 (]: Timing info for model.coffee_shop_alh.customers (compile): 2023-05-18 19:46:36.262395 => 2023-05-18 19:46:36.264384
[0m19:46:36.264981 [debug] [Thread-1 (]: Began executing node model.coffee_shop_alh.customers
[0m19:46:36.311790 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_alh.customers"
[0m19:46:36.313353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:46:36.313975 [debug] [Thread-1 (]: On model.coffee_shop_alh.customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "coffee_shop_alh", "target_name": "dev", "node_id": "model.coffee_shop_alh.customers"} */


  create or replace view `aec-students`.`dbt_alh`.`customers`
  OPTIONS()
  as SELECT 
	orders.customer_id AS customer_id,
	customers.name AS name,
	customers.email AS email,
	MIN(orders.created_at) AS first_order_at,
	COUNT(orders.created_at) AS nr_of_orders
FROM `analytics-engineers-club.coffee_shop.customers` AS customers
INNER JOIN `analytics-engineers-club.coffee_shop.orders` AS orders ON customers.id=orders.customer_id
GROUP BY 
	customer_id,
	name,
	email
ORDER BY first_order_at limit 5;;


[0m19:46:36.563969 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got ";" at [18:33]')
[0m19:46:37.376524 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:54eef0f8-2130-4060-8ed5-c397531b5da3&page=queryresults
[0m19:46:37.378951 [debug] [Thread-1 (]: Timing info for model.coffee_shop_alh.customers (execute): 2023-05-18 19:46:36.265344 => 2023-05-18 19:46:37.378654
[0m19:46:37.383590 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Syntax error: Expected end of input but got ";" at [18:33]
  compiled Code at target/run/coffee_shop_alh/models/customers.sql
[0m19:46:37.384467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93715c90-f03f-4309-83b5-796c58d11441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb087135f60>]}
[0m19:46:37.385087 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_alh.customers ......................... [[31mERROR[0m in 1.12s]
[0m19:46:37.387373 [debug] [Thread-1 (]: Finished running node model.coffee_shop_alh.customers
[0m19:46:37.389394 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:46:37.390042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:37.390284 [debug] [MainThread]: Connection 'model.coffee_shop_alh.customers' was properly closed.
[0m19:46:37.390570 [info ] [MainThread]: 
[0m19:46:37.391167 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m19:46:37.391802 [debug] [MainThread]: Command end result
[0m19:46:37.400804 [info ] [MainThread]: 
[0m19:46:37.401309 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:46:37.401767 [info ] [MainThread]: 
[0m19:46:37.402241 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m19:46:37.402747 [error] [MainThread]:   Syntax error: Expected end of input but got ";" at [18:33]
[0m19:46:37.403417 [error] [MainThread]:   compiled Code at target/run/coffee_shop_alh/models/customers.sql
[0m19:46:37.403949 [info ] [MainThread]: 
[0m19:46:37.404676 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:46:37.405341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb08ac0bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb08ab7ad40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0873dc730>]}
[0m19:46:37.405931 [debug] [MainThread]: Flushing usage events


============================== 2023-05-18 19:51:58.715296 | 20fd1bca-f58e-42bd-a17d-6f6b9a112575 ==============================
[0m19:51:58.715296 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:51:58.718053 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:51:58.718565 [debug] [MainThread]: Tracking: tracking
[0m19:51:58.720746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30267925f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30228a56c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30228a5300>]}
[0m19:51:58.737898 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:51:58.772674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:51:58.773485 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_alh://models/customers.sql
[0m19:51:58.806667 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m19:51:58.830988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20fd1bca-f58e-42bd-a17d-6f6b9a112575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30222bc0d0>]}
[0m19:51:58.921276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20fd1bca-f58e-42bd-a17d-6f6b9a112575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3022a16b30>]}
[0m19:51:58.921772 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 336 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:51:58.922238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20fd1bca-f58e-42bd-a17d-6f6b9a112575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30267925f0>]}
[0m19:51:58.923466 [info ] [MainThread]: 
[0m19:51:58.925467 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:51:58.926698 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m19:51:58.927184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:00.113631 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_alh'
[0m19:52:00.114171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:00.380910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20fd1bca-f58e-42bd-a17d-6f6b9a112575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3022de1ed0>]}
[0m19:52:00.382065 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m19:52:00.383543 [info ] [MainThread]: 
[0m19:52:00.390022 [debug] [Thread-1 (]: Began running node model.coffee_shop_alh.customers
[0m19:52:00.390454 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_alh.customers .................................. [RUN]
[0m19:52:00.391230 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_alh.customers'
[0m19:52:00.391525 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_alh.customers
[0m19:52:00.393789 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_alh.customers"
[0m19:52:00.394323 [debug] [Thread-1 (]: Timing info for model.coffee_shop_alh.customers (compile): 2023-05-18 19:52:00.391721 => 2023-05-18 19:52:00.394243
[0m19:52:00.394674 [debug] [Thread-1 (]: Began executing node model.coffee_shop_alh.customers
[0m19:52:00.424730 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_alh.customers"
[0m19:52:00.426103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:00.427223 [debug] [Thread-1 (]: On model.coffee_shop_alh.customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "coffee_shop_alh", "target_name": "dev", "node_id": "model.coffee_shop_alh.customers"} */


  create or replace view `aec-students`.`dbt_alh`.`customers`
  OPTIONS()
  as SELECT 
	orders.customer_id AS customer_id,
	customers.name AS name,
	customers.email AS email,
	MIN(orders.created_at) AS first_order_at,
	COUNT(orders.created_at) AS nr_of_orders
FROM `analytics-engineers-club.coffee_shop.customers` AS customers
INNER JOIN `analytics-engineers-club.coffee_shop.orders` AS orders ON customers.id=orders.customer_id
GROUP BY 
	customer_id,
	name,
	email
ORDER BY first_order_at limit 5;


[0m19:52:01.246148 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4679c1b0-12a0-443a-b93f-c8c5316135a3&page=queryresults
[0m19:52:01.262529 [debug] [Thread-1 (]: Timing info for model.coffee_shop_alh.customers (execute): 2023-05-18 19:52:00.394928 => 2023-05-18 19:52:01.262460
[0m19:52:01.263342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20fd1bca-f58e-42bd-a17d-6f6b9a112575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3022875bd0>]}
[0m19:52:01.263898 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_alh.customers ............................. [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m19:52:01.266144 [debug] [Thread-1 (]: Finished running node model.coffee_shop_alh.customers
[0m19:52:01.268644 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:52:01.269372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:01.269716 [debug] [MainThread]: Connection 'model.coffee_shop_alh.customers' was properly closed.
[0m19:52:01.270060 [info ] [MainThread]: 
[0m19:52:01.270604 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m19:52:01.271243 [debug] [MainThread]: Command end result
[0m19:52:01.291198 [info ] [MainThread]: 
[0m19:52:01.291906 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:52:01.292534 [info ] [MainThread]: 
[0m19:52:01.293526 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:52:01.294123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302627e260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3022aabe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3022db7430>]}
[0m19:52:01.294784 [debug] [MainThread]: Flushing usage events


============================== 2023-05-18 19:55:44.831713 | 6bb4cd51-0768-4232-b91a-84d798d999d3 ==============================
[0m19:55:44.831713 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:55:44.834477 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:55:44.834994 [debug] [MainThread]: Tracking: tracking
[0m19:55:44.837538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff597fc5060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff597fc40a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff597fc5030>]}
[0m19:55:44.855919 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:55:44.893931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m19:55:44.894760 [debug] [MainThread]: Partial parsing: added file: coffee_shop_alh://models/monthly_customers.sql
[0m19:55:44.895452 [debug] [MainThread]: Partial parsing: added file: coffee_shop_alh://models/customers.yml
[0m19:55:44.896125 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_alh://models/customers.sql
[0m19:55:44.919241 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
[0m19:55:44.933479 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m19:55:45.019409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff59811aef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5983e41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5983e4160>]}
[0m19:55:45.019984 [debug] [MainThread]: Flushing usage events
[0m19:55:45.162400 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop_alh.customers' (models/customers.sql) depends on a source named 'coffee_shop.orders' which was not found


============================== 2023-05-19 16:00:14.534538 | 4b085100-5117-4206-b4db-cfd5872df94b ==============================
[0m16:00:14.534538 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:00:14.543664 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:00:14.544163 [debug] [MainThread]: Tracking: tracking
[0m16:00:14.548733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5987aad0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5987aaf580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5987aad090>]}
[0m16:00:14.570761 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:00:14.726069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m16:00:14.726570 [debug] [MainThread]: Partial parsing: added file: coffee_shop_alh://models/monthly_customers.sql
[0m16:00:14.726954 [debug] [MainThread]: Partial parsing: added file: coffee_shop_alh://models/sources.yml
[0m16:00:14.727251 [debug] [MainThread]: Partial parsing: added file: coffee_shop_alh://models/customers.yml
[0m16:00:14.727557 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_alh://models/customers.sql
[0m16:00:14.746417 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
[0m16:00:14.763213 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m16:00:14.902626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b085100-5117-4206-b4db-cfd5872df94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598751c0d0>]}
[0m16:00:14.912545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b085100-5117-4206-b4db-cfd5872df94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59874dcdf0>]}
[0m16:00:14.913263 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 336 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:00:14.913889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b085100-5117-4206-b4db-cfd5872df94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59874e60e0>]}
[0m16:00:14.915833 [info ] [MainThread]: 
[0m16:00:14.918911 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:00:14.920695 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:00:14.921510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:18.939643 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_alh'
[0m16:00:18.940225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:19.153138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b085100-5117-4206-b4db-cfd5872df94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59874df280>]}
[0m16:00:19.154139 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:00:19.154952 [info ] [MainThread]: 
[0m16:00:19.166646 [debug] [Thread-1 (]: Began running node model.coffee_shop_alh.customers
[0m16:00:19.167132 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_alh.customers ................................. [RUN]
[0m16:00:19.168015 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_alh.customers'
[0m16:00:19.168322 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_alh.customers
[0m16:00:19.172423 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_alh.customers"
[0m16:00:19.172975 [debug] [Thread-1 (]: Timing info for model.coffee_shop_alh.customers (compile): 2023-05-19 16:00:19.168499 => 2023-05-19 16:00:19.172878
[0m16:00:19.173360 [debug] [Thread-1 (]: Began executing node model.coffee_shop_alh.customers
[0m16:00:19.196494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:19.558288 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_alh.customers"
[0m16:00:19.559465 [debug] [Thread-1 (]: On model.coffee_shop_alh.customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "coffee_shop_alh", "target_name": "dev", "node_id": "model.coffee_shop_alh.customers"} */

  
    

    create or replace table `aec-students`.`dbt_alh`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club`.`coffee_shop`.`customers` as customers 
left join customer_orders
    on id = customer_orders.customer_id
    );
  
[0m16:00:26.229715 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1e837065-3f8f-4fa6-9174-64757e3f6b77&page=queryresults
[0m16:00:26.248707 [debug] [Thread-1 (]: Timing info for model.coffee_shop_alh.customers (execute): 2023-05-19 16:00:19.173544 => 2023-05-19 16:00:26.248645
[0m16:00:26.249472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b085100-5117-4206-b4db-cfd5872df94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5987525720>]}
[0m16:00:26.250391 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_alh.customers ............................ [[32mCREATE TABLE (174.4k rows, 21.3 MB processed)[0m in 7.08s]
[0m16:00:26.252220 [debug] [Thread-1 (]: Finished running node model.coffee_shop_alh.customers
[0m16:00:26.253550 [debug] [Thread-3 (]: Began running node model.coffee_shop_alh.monthly_customers
[0m16:00:26.253952 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_alh.monthly_customers .......................... [RUN]
[0m16:00:26.254691 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop_alh.monthly_customers'
[0m16:00:26.254955 [debug] [Thread-3 (]: Began compiling node model.coffee_shop_alh.monthly_customers
[0m16:00:26.260401 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop_alh.monthly_customers"
[0m16:00:26.261111 [debug] [Thread-3 (]: Timing info for model.coffee_shop_alh.monthly_customers (compile): 2023-05-19 16:00:26.255122 => 2023-05-19 16:00:26.261045
[0m16:00:26.261497 [debug] [Thread-3 (]: Began executing node model.coffee_shop_alh.monthly_customers
[0m16:00:26.280453 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop_alh.monthly_customers"
[0m16:00:26.281288 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:00:26.281709 [debug] [Thread-3 (]: On model.coffee_shop_alh.monthly_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "coffee_shop_alh", "target_name": "dev", "node_id": "model.coffee_shop_alh.monthly_customers"} */


  create or replace view `aec-students`.`dbt_alh`.`monthly_customers`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
 
from `aec-students`.`dbt_alh`.`customers`
 
group by 1;


[0m16:00:27.221792 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:752650f5-7661-4d55-895c-a28132b1511f&page=queryresults
[0m16:00:27.223805 [debug] [Thread-3 (]: Timing info for model.coffee_shop_alh.monthly_customers (execute): 2023-05-19 16:00:26.261745 => 2023-05-19 16:00:27.223742
[0m16:00:27.224599 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b085100-5117-4206-b4db-cfd5872df94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5987526200>]}
[0m16:00:27.225128 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_alh.monthly_customers ..................... [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m16:00:27.226086 [debug] [Thread-3 (]: Finished running node model.coffee_shop_alh.monthly_customers
[0m16:00:27.227932 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:00:27.228490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:27.228710 [debug] [MainThread]: Connection 'model.coffee_shop_alh.customers' was properly closed.
[0m16:00:27.228914 [debug] [MainThread]: Connection 'model.coffee_shop_alh.monthly_customers' was properly closed.
[0m16:00:27.229157 [info ] [MainThread]: 
[0m16:00:27.229534 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 12.31 seconds (12.31s).
[0m16:00:27.230369 [debug] [MainThread]: Command end result
[0m16:00:27.238327 [info ] [MainThread]: 
[0m16:00:27.238807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:27.239281 [info ] [MainThread]: 
[0m16:00:27.239762 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:00:27.240641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5987a56830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59874dec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59874dd0c0>]}
[0m16:00:27.241025 [debug] [MainThread]: Flushing usage events
